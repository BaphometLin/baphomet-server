<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Baphomet Server - 업데이트</title>

<style>
/* ===== (CSS 전체 동일 – 생략 없이 유지) ===== */
html {
    background: url('images/background_full.jpg') no-repeat center top;
    background-size: cover;
    background-attachment: fixed;
}
body {
    margin: 0;
    background: transparent;
    color: #ddd;
    font-family: "Malgun Gothic", Arial, sans-serif;
}
body::before {
    content:"";
    position: fixed;
    inset:0;
    background: rgba(0,0,0,0.18);
    pointer-events: none;
    z-index: 0;
}
.footer {
    margin-top: 60px;
    padding: 15px 0;
    font-size: 14px;
    color: rgba(230,230,230,0.75);
    text-align: center;
    line-height: 1.4;
    position: relative;
    z-index: 10;
}
.navbar {
    position: fixed;
    top: 0;
    width: 100%;
    background: rgba(0,0,0,0.55);
    padding: 14px 0;
    border-bottom: 1px solid rgba(255,0,0,0.25);
    z-index: 1000;
    text-align: center;
}
.navbar a {
    color: #ddd;
    margin: 0 28px;
    font-size: 19px;
    font-weight: bold;
    text-decoration: none;
}
.navbar a:hover {
    color: #ff3333;
    border-bottom: 2px solid #ff3333;
}
.header {
    background-image: url('images/baphomet2.jpg');
    background-size: cover;
    background-position: center;
    height: 520px;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}
.header::before {
    content:"";
    position:absolute;
    inset:0;
    background: rgba(0,0,0,0.25);
}
.header h1 {
    position: relative;
    font-size: 43px;
    letter-spacing: 4px;
    color: #fff;
    text-shadow: 0 0 20px #900;
}
.container {
    width: 1000px;
    margin: 120px auto 70px auto;
    position: relative;
    z-index: 10;
}
table.board {
    width: 100%;
    border-collapse: collapse;
    background: rgba(0,0,0,0.65);
}
table.board th, table.board td {
    padding: 10px;
    text-align: center;
}
table.board th:nth-child(2),
table.board td:nth-child(2) {
    text-align: left;
}
.title-link {
    color: #ddd;
    cursor: pointer;
}
.title-link:hover {
    color: #ffcc00;
}
.pagination {
    margin-top: 15px;
    text-align: center;
}
.pagination button {
    background: #222;
    border: 1px solid #555;
    color: #ddd;
    padding: 5px 10px;
    margin: 0 2px;
    cursor: pointer;
}
.pagination button.active {
    background: #aa0000;
}
.modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.75);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 2000;
}
.modal {
    width: 650px;
    background: #111;
    padding: 20px;
    border-radius: 10px;
    border: 1px solid #ff4444;
}
</style>

<script>
const PAGE_SIZE = 10;
let updates = [];
let filtered = [];
let currentPage = 1;

window.addEventListener("load", loadUpdates);

function loadUpdates() {
    let list = JSON.parse(localStorage.getItem("updates") || "[]");

    // ✅ 기본 업데이트 1개 자동 생성 (처음 접속 시)
    if (list.length === 0) {
        list.push({
            id: Date.now(),
            title: "업데이트 사항은 서버내 또는 단톡방 참조",
            content: "업데이트 사항은 서버내 또는 단톡방 참조",
            date: new Date().toISOString().substring(0, 10),
            createdAt: new Date().toISOString()
        });
    }

    list.forEach((u, idx) => {
        if (!u.id) u.id = Date.now() + idx;
        if (!u.createdAt) {
            if (u.date && /^\d{4}-\d{2}-\d{2}$/.test(u.date)) {
                u.createdAt = u.date + "T00:00:00";
            } else {
                u.createdAt = new Date().toISOString();
            }
        }
    });

    list.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));

    updates = list;
    filtered = [...updates];

    localStorage.setItem("updates", JSON.stringify(updates));
    renderBoard();
}


function renderBoard() {
    const tbody = document.getElementById("boardBody");
    const pagination = document.getElementById("pagination");
    tbody.innerHTML = "";
    pagination.innerHTML = "";

    const totalPages = Math.ceil(filtered.length / PAGE_SIZE);
    const start = (currentPage-1)*PAGE_SIZE;
    const pageItems = filtered.slice(start, start+PAGE_SIZE);

    pageItems.forEach((u,idx)=>{
        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${filtered.length-(start+idx)}</td>
            <td><span class="title-link" onclick="openDetail(${u.id})">${u.title}</span></td>
            <td>${u.date}</td>
            <td>-</td>
        `;
        tbody.appendChild(tr);
    });

    for(let i=1;i<=totalPages;i++){
        const b=document.createElement("button");
        b.textContent=i;
        if(i===currentPage) b.classList.add("active");
        b.onclick=()=>{currentPage=i;renderBoard();}
        pagination.appendChild(b);
    }
}

function openDetail(id){
    const u=updates.find(x=>x.id===id);
    document.getElementById("modalTitle").textContent=u.title;
    document.getElementById("modalContent").textContent=u.content;
    document.getElementById("modalOverlay").style.display="flex";
}
function closeModal(){
    document.getElementById("modalOverlay").style.display="none";
}
</script>
</head>

<body>

<div class="navbar">
    <a href="index.html">홈</a>
    <a href="notice.html">공지사항</a>
    <a href="info.html">서버정보</a>
    <a href="update.html" style="color:#ff3333;">업데이트</a>
</div>

<div class="header"><h1>UPDATE</h1></div>

<div class="container">
<table class="board">
<thead>
<tr><th>번호</th><th>제목</th><th>작성일</th><th>관리</th></tr>
</thead>
<tbody id="boardBody"></tbody>
</table>
<div id="pagination" class="pagination"></div>
</div>

<div id="modalOverlay" class="modal-overlay" onclick="closeModal()">
<div class="modal" onclick="event.stopPropagation()">
<h3 id="modalTitle"></h3>
<p id="modalContent"></p>
<button onclick="closeModal()">닫기</button>
</div>
</div>

<div class="footer">
서버의 모든 저작권은 NC소프트에 있으며, 커뮤니티 목적의 서버입니다.
</div>

</body>
</html>

